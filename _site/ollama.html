



<!doctype html>
<html>
<head>
  
 
  

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta name="viewport" content="width=device-width">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ollama | HakoDocs</title>
<meta name="generator" content="Jekyll v3.10.0" />
<meta property="og:title" content="Ollama" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Ollama" />
<meta property="og:description" content="Ollama" />
<link rel="canonical" href="http://localhost:4000/ollama" />
<meta property="og:url" content="http://localhost:4000/ollama" />
<meta property="og:site_name" content="HakoDocs" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ollama" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Ollama","headline":"Ollama","url":"http://localhost:4000/ollama"}</script>
<!-- End Jekyll SEO tag -->





<title>ollama - HakoDocs</title>

<meta property="og:title" content="ollama - HakoDocs">

<meta property="og:description" content="
        A collection of tech-related notes
      ">


<meta property="og:url"
  content="http://localhost:4000/ollama" />





  

<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>
<!--mathjax support-->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
<!--custom js-->
<script src="/assets/js/custom.js"></script>

<script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
    crossorigin="anonymous"></script>
<script src="/assets/js/checkLinks.js"></script>
<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

<!-- dark mode -->
<style>
  body {
    visibility: hidden;
    opacity: 0;
  }
</style>
<noscript>
  <style>
    body {
      visibility: visible;
      opacity: 1;
    }
  </style>
</noscript>
<script>
  function darkModeSetBodyBg() {
    if (localStorage.getItem('darkmode')==="true") {
      console.log("darkmode activated");
      document.body.style.backgroundColor = "black !important";
    } else {
      document.body.style.backgroundColor = ""; // reset background color
    }
  }

  function addDarkmodeWidget() {

    const options = {
        label: 'ðŸŒ“', // default: ''
        time: '0s'
    }

    new Darkmode(options).showWidget();

    document.body.style.visibility = 'visible';
    document.body.style.opacity = 1;
  }

  $(document).ready(addDarkmodeWidget);
</script>



  

<link rel="stylesheet" href="/assets/css/git-wiki-style.css?v=9812f36d5ab6e1ae64f0964130612cb6b8958ceb">



  
</head>

<body style="background-color: black;" onload="darkModeSetBodyBg()">
    <!-- dark mode -->
    <script>
        darkModeSetBodyBg()
    </script>
    
    <div class="wrapper">
    <div class=" w3-xlarge w3-hide-large" id="git-wiki-mobile-header">
  <button class="w3-button w3-teal" onclick="sidebar_toggle()">&#9776;</button>
  <a href="/">
    
    HakoDocs
  </a>
</div>
<header class="w3-sidebar w3-bar-block w3-collapse" id="git-wiki-sidebar">
  <div>
    <button class="w3-bar-item w3-button w3-large w3-hide-large" onclick="sidebar_toggle()">Close &times;</button>
    

    <div class="w3-hide-medium w3-hide-small">
      
      <h1>HakoDocs</h1>
      
    </div>


    

    
    <ul class="git-wiki-downloads">
    <li><a href="https://github.com/leogabac/hakodocs/zipball/gh-pages">Download <strong>ZIP File</strong></a></li>
    <li><a href="https://github.com/leogabac/hakodocs/tarball/gh-pages">Download <strong>TAR Ball</strong></a></li>
    <li><a href="https://github.com/leogabac/hakodocs">View On <strong> Github  </strong></a></li>
</ul>

    

    
    <div class="git-wiki-page-list">
    
    Menu (<a href="https://github.com/leogabac/hakodocs/edit/master/_includes/sidebar.html">Edit</a>):

<ul>
  <li><a href="/">Home</a></li>
</ul>

    

    <span class="page-list-title">Pages  (Latest 10 updated) :</span>
    <ul class="page-list">
        
        
        
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/linux.docker">Docker</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/latex">LaTeX</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/inkscape">Inkscape</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/timeshift">Timeshift</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/zerotier">ZeroTier</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/sunshine">Sushine/Moonlight</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/steam">Steam</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/python">Python</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/python.jupyter">Jupyter Notebooks</a>
        </li>
        
        

        
        
        
        <li class="page-list-item">
            
            <a href="/ollama.openwebui">Ollama: Open WebUI</a>
        </li>
        
        

        
        
        
    </ul>

    
</div>
    

    
    <div class="git-wiki-page-list">
    

    <span class="post-list-title">Posts  (Latest 10 updated) :</span>
    <ul class="post-list">
        
        
        
    </ul>

    <span class="post-list read-all"><a href="/assets/blog/">Read all</a></span>

    
</div>
    

    
  </div>
</header>
<script>
  function sidebar_toggle() {
    var sidebar = document.getElementById("git-wiki-sidebar");
    if (sidebar.style.display == "block") {
      sidebar.style.display = "none";
      sidebar.style.position = "inherit";
    } else {
      $(sidebar).attr('style', 'display: block;');
    }
  }
</script>

    <div class="git-wiki-page">
  <section>

    <div id="tools-buttons" style="width: 100%; text-align: right">
    

    <div class="git-wiki-tools">
    

    

    <span class="tools-element"><a target="_blank" href="https://github.com/leogabac/hakodocs/commits/master//wiki/ollama/ollama.md">History</a></span>
    <span class="tools-element"><a target="_blank" href="https://github.com/leogabac/hakodocs/blob/master//wiki/ollama/ollama.md">Source</a></span>
    
    <span class="tools-element"><a target="_blank" href="https://github.com/leogabac/hakodocs/new/master/_posts?filename=">Add
            new post</a></span>
    
    
    <br>
    Prose.io:
    <span class="tools-element"><a target="_blank" href="http://prose.io/#leogabac/hakodocs/new/master/wiki">Add
            new</a></span>
    <span class="tools-element"><a target="_blank" href="http://prose.io/#leogabac/hakodocs/edit/master/wiki/ollama/ollama.md">Edit</a></span>
    
    <span class="tools-element"><a target="_blank" href="http://prose.io/#leogabac/hakodocs/new/master/_posts/">Add
            new post</a></span>
    
    
    
</div>


    <div class="git-wiki-search">
    

    
    
    <div class="git-wiki-search-js">
	<input type="text" id="search-input" placeholder="Search..">
	<ul id="results-container"></ul>
</div>
<!-- script pointing to jekyll-search.js -->
<script src="/assets/js/simple-jekyll-search.min.js"></script>
<script async src="/assets/js/searchdata.js"></script>

</div>

    
</div>

    




    Table of Contents:
    <ol id="git-wiki-toc">
  <li><a href="#ollama">Ollama</a>
    <ol>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#running-a-model">Running a model</a></li>
    </ol>
  </li>
  <li><a href="#amd-gpus">AMD GPUs</a></li>
  <li><a href="#see-also">See also</a></li>
</ol>



<!--


    Table of Contents:
    <ol id="sidebar-toc">
  <li><a href="#ollama">Ollama</a>
    <ol>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#running-a-model">Running a model</a></li>
    </ol>
  </li>
  <li><a href="#amd-gpus">AMD GPUs</a></li>
  <li><a href="#see-also">See also</a></li>
</ol>
-->

<!--


    Table of Contents:
    <ul id="sidebar-toc">
  <li><a href="#ollama">Ollama</a>
    <ul>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#running-a-model">Running a model</a></li>
    </ul>
  </li>
  <li><a href="#amd-gpus">AMD GPUs</a></li>
  <li><a href="#see-also">See also</a></li>
</ul>
-->

<button id="toggle-toc" class="toggle-toc-btn">â˜° </button>

<div id="sidebar-toc">
    <button id="close-toc" class="close-toc-btn">âœ–</button>
    <div class="toc-content">
        <!--


    Table of Contents:
    <ol id="inline-toc">
  <li><a href="#ollama">Ollama</a>
    <ol>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#running-a-model">Running a model</a></li>
    </ol>
  </li>
  <li><a href="#amd-gpus">AMD GPUs</a></li>
  <li><a href="#see-also">See also</a></li>
</ol>
-->
        


    Table of Contents:
    <ol id="floating_toc">
  <li><a href="#ollama">Ollama</a>
    <ol>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#running-a-model">Running a model</a></li>
    </ol>
  </li>
  <li><a href="#amd-gpus">AMD GPUs</a></li>
  <li><a href="#see-also">See also</a></li>
</ol>

    </div>
</div>






    

    <div id="git-wiki-content">
      <h1 id="ollama">Ollama</h1>

<p>Ollama is an application that lets you download and run offline LLMs.</p>

<h2 id="installation">Installation</h2>

<p>Generally for Linux:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-fsSL</span> https://ollama.com/install.sh | sh
</code></pre></div></div>

<p>For Arch Linux you can install one of three packages</p>
<ol>
  <li><code class="language-plaintext highlighter-rouge">ollama</code> for CPU Models</li>
  <li><code class="language-plaintext highlighter-rouge">ollama-cuda</code> for NVIDIA GPUs</li>
  <li><code class="language-plaintext highlighter-rouge">ollama-rocm</code> for AMD GPUs</li>
</ol>

<p>Then start/enable the daemon</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl start ollama.service
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>ollama.service
</code></pre></div></div>

<p>Or simply run in a command line for quick testing</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ollama serve
</code></pre></div></div>

<h2 id="running-a-model">Running a model</h2>

<p>To run a model, first look in the <a href="https://ollama.com/library">Ollama library</a> for the model name you want to use. For example</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ollama run deepseek-r1:1.5b
</code></pre></div></div>

<p>This will download, run and start the prompt in a therminal with the LLM.</p>

<blockquote class="tip">
  <p>In the model, write <code class="language-plaintext highlighter-rouge">/?</code> for help and <code class="language-plaintext highlighter-rouge">/bye</code> to exit.</p>
</blockquote>

<h1 id="amd-gpus">AMD GPUs</h1>

<p>Ollama has <a href="https://ollama.com/blog/amd-preview">limited support</a> for AMD discrete GPUs since the ROCm technology only support a few, and very recent models. Nevertheless, it is still possible to offload ollamaâ€™s processing into unsopported integrated or discrete GPUs by changing the <code class="language-plaintext highlighter-rouge">HSA_OVERRIDE_GFX_VERSION</code> environment variable when launching ollama.</p>

<p>First we need to figure out the <em>GFX</em> version that applies to your particular GPU. Extracted from the <a href="https://wiki.archlinux.org/title/Ollama">Ollama Arch Wiki Page</a>, first execute.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/opt/rocm/bin/rocminfo | <span class="nb">grep </span>amdhsa
</code></pre></div></div>
<p>This will query the exact GFX version to your system. It will give you either three of four digits.</p>
<ul>
  <li>If you have four digits, they are interpreted as <code class="language-plaintext highlighter-rouge">XXYZ</code>.</li>
  <li>If you have three digits, then <code class="language-plaintext highlighter-rouge">XYZ</code></li>
</ul>

<p>Remember these digits, as your GFX version is either <code class="language-plaintext highlighter-rouge">XX.Y.Z</code> or <code class="language-plaintext highlighter-rouge">X.Y.Z</code> depending on whether you got three or four digits.</p>

<p>Then find all of the installed <code class="language-plaintext highlighter-rouge">rocblas</code> kernels</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find /opt/rocm/lib/rocblas/library <span class="nt">-name</span> <span class="s1">'Kernels.so-*'</span>
</code></pre></div></div>
<p>And find the closest to your actual version following these rules</p>
<ol>
  <li>For the <code class="language-plaintext highlighter-rouge">X</code> part, it must be strictly equal to the actual version.</li>
  <li>For the <code class="language-plaintext highlighter-rouge">Y</code> part, mismatch is allowed, but it must be no greater than the the actual version.</li>
  <li>For the <code class="language-plaintext highlighter-rouge">Z</code> part, mismatch is allowed, but it must be no greater than the the actual version.</li>
</ol>

<p>As a test, if running, stop the ollama daemon</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl stop ollama.service
</code></pre></div></div>
<p>Execute the following with your GFX version</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">HSA_OVERRIDE_GFX_VERSION</span><span class="o">=</span>X.Y.Z ollama serve
</code></pre></div></div>
<p>and run a model to test if the GPU is now being used. If it is still not being used, follow the same steps to figure out the correct GFX version until you get the right numbers.</p>

<p>Once you made sure which is the correct environment variable, edit the ollama daemon</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl edit <span class="nt">--full</span> ollama.service
</code></pre></div></div>
<p>This will open the daemon configuration file, look for the <code class="language-plaintext highlighter-rouge">[Service]</code> section and add</p>

<div class="language-plaintext codeblock highlighter-rouge" data-title="/etc/systemd/system/ollama.service"><div class="highlight"><pre class="highlight"><code>[Service]
Environment="HSA_OVERRIDE_GFX_VERSION=X.Y.Z"
ExecStart=/usr/bin/ollama serve
</code></pre></div></div>

<p>Finally, perform a daemon reload</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl daemon-reload
</code></pre></div></div>
<p>and restart the ollama daemon</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl restart ollama.service
</code></pre></div></div>

<h1 id="see-also">See also</h1>
<ul>
  <li><a href="ollama.openwebui">Ollama: Open WebUI</a></li>
</ul>

    </div>

    
  </section>
</div>
    <footer>
    

    
<div class="git-wiki-copyrights">
    <p>This project is maintained by <a href="https://github.com/leogabac">leogabac</a></p>
    
    <p><small>Hosted on GitHub Pages &mdash; Powered by <a href="https://github.com/Drassil/git-wiki-theme">Git-Wiki v2.8.6</a> </p>

    
    <p class="view"><a href="https://github.com/leogabac/hakodocs">View the Project on  Github  <small></small></a></p>
</div>



    
</footer>
</div>

    

<script src="/assets/js/scale.fix.js"></script>






<script type="text/javascript">
    $(document).ready(function () {
        $(document.body).checkLinks("/404.html,/archlinux,/contributions,/cpp.armadillo,/cpp.fft,/cpp,/git.github,/git,/home,/assets/blog/,/julia,/linux.clitips,/linux.dump.laggy_suspend,/linux.dump,/linux.settings,/minecraft,/ollama,/ollama.openwebui,/python.jupyter,/python,/steam,/sunshine,/zerotier,/timeshift,/inkscape,/latex,/linux.docker,/,".split(","));
    });
</script>



</body>

</html>